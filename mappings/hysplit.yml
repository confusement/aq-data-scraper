prefixes:
  aq: "http://www.semanticweb.org/saadf/ontologies/2021/2/AirQualityOntology#"

mappings:
  # Trajectory
  backTrajectory:
    sources:
      - access: _filename
        referenceFormulation: csv
    s: aq:hs__locname_$(uuid)
    po:
      - [a, aq:BackTrajectoryPoint]
      - [aq:atTime, $(timestamp)]
      - [aq:latitude, $(latitude)]
      - [aq:longitude, $(longitude)]
      - [aq:atHeight, $(height)]
      - [aq:nearby, $(nearby)]
      - p: aq:nextFix
        o:
          - mapping: helper
            condition:
              function: equal
              parameters:
                - [str1, $(nextuuid)]
                - [str2, $(uuid)]

  helper:
    sources:
      - access: _filename
        referenceFormulation: csv
    s: aq:hs__locname_$(uuid)

  observationfirst:
    sources:
      - access: _filename
        referenceFormulation: csv
    s: aq:hs__locname_$(uuid)
    condition:
      function: equal
      parameters:
        - [str1, $(firstlast)]
        - [str2, "first"]
    po:
      - [a, aq:Observation]
      - [a, aq:BackTrajectoryParameter]
      - [a, aq:StartingBackTrajectoryPoint]
      - [aq:placeName, $(orgplaceiri)]

  observationlast:
    sources:
      - access: _filename
        referenceFormulation: csv
    s: aq:hs__locname_$(uuid)
    condition:
      function: equal
      parameters:
        - [str1, $(firstlast)]
        - [str2, "last"]
    po:
      - [a, aq:EndingBackTrajectoryPoint]
